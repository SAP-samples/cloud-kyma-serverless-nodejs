'use strict';

/*********************************************************************************************************************/
/** defined types: sasl layer ****************************************************************************************/
/*********************************************************************************************************************/

/**
 * @typedef {string} SaslMechanismList
 */

/**
 * @typedef {string} SaslMechanism
 */

/**
 * @typedef {number} SaslOutcome
 */

/**
 * @typedef {Object} SaslData
 * @param {string} identity - The identity (used for all supported mechanisms}
 * @param {string} user - The user name in case of PLAIN mechanism
 * @param {string} password - The password in case of mechanism PLAIN
 */

/**
 * @typedef {Object} SaslClientConfig
 * @property {string} mechanism - The mechanisms to use, separated by space, sorted by priority, by default 'PLAIN ANONYMOUS EXTERNAL'. Initial means to skip SASL completely.
 * @property {string} identity - The remote identity, required for EXTERNAL, optional for PLAIN and ANONYMOUS.
 * @property {string} user - The remote user (mechanism PLAIN).
 * @property {string} password - The remote user password (mechanism PLAIN).
 */

/**
 * @typedef {Object} SaslServerConfig
 * @property {SaslMechanismList} mechanism - The mechanism to be used or a space separated list for multiple
 * @property {boolean} mandatory - SASL authentication mandatory; immediate start with AMQP not allowed
 */

/**
 * @callback SaslAuthenticate
 * @param {SaslMechanism} mechanism - The mechanism selected by the client
 * @param {SaslData} data - The mechanism-specific data (identity, user, password)
 * @param {SaslAuthenticateCallback} callback - The callback to provide validation results
 */

/**
 * @callback SaslAuthenticateCallback
 * @param {Error=} error - An error object to describe details of failure
 * @param {SaslOutcome=} outcome - The outcome code, 0(OK), 1(AUTH), 2(SYS), 3(SYS_PERM), 4 (SYS_TEMP)
 */

/**
 * @callback NotifyOfSaslDone
 * @param {string} mechanism
 */

